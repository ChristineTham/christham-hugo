/*!
  * PhotoSwipe Lightbox 5.3.0 - https://photoswipe.com
  * (c) 2022 Dmytro Semenov
  */function createElement(e,t,n){const s=document.createElement(t||"div");return e&&(s.className=e),n&&n.appendChild(s),s}function toTransformString(e,t,n){let s="translate3d("+e+"px,"+(t||0)+"px,0)";return n!==void 0&&(s+=" scale3d("+n+","+n+",1)"),s}function setWidthHeight(e,t,n){e.style.width=typeof t=="number"?t+"px":t,e.style.height=typeof n=="number"?n+"px":n}const LOAD_STATE={IDLE:"idle",LOADING:"loading",LOADED:"loaded",ERROR:"error"};function specialKeyUsed(e){if(e.which===2||e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)return!0}function getElementsFromOption(e,t,n=document){let s=[];if(e instanceof Element)s=[e];else if(e instanceof NodeList||Array.isArray(e))s=Array.from(e);else{const o=typeof e=="string"?e:t;o&&(s=Array.from(n.querySelectorAll(o)))}return s}function isPswpClass(e){return typeof e=="function"&&e.prototype&&e.prototype.goTo}function isSafari(){return!!(navigator.vendor&&navigator.vendor.match(/apple/i))}class PhotoSwipeEvent{constructor(e,t){this.type=e,t&&Object.assign(this,t)}preventDefault(){this.defaultPrevented=!0}}class Eventable{constructor(){this._listeners={},this._filters={},this.pswp=void 0,this.options=void 0}addFilter(e,t,n=100){this._filters[e]||(this._filters[e]=[]),this._filters[e].push({fn:t,priority:n}),this._filters[e].sort((e,t)=>e.priority-t.priority),this.pswp&&this.pswp.addFilter(e,t,n)}removeFilter(e,t){this._filters[e]&&(this._filters[e]=this._filters[e].filter(e=>e.fn!==t)),this.pswp&&this.pswp.removeFilter(e,t)}applyFilters(t,...e){return this._filters[t]&&this._filters[t].forEach(t=>{e[0]=t.fn.apply(this,e)}),e[0]}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t),this.pswp&&this.pswp.on(e,t)}off(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(e=>t!==e)),this.pswp&&this.pswp.off(e,t)}dispatch(e,t){if(this.pswp)return this.pswp.dispatch(e,t);const n=new PhotoSwipeEvent(e,t);return this._listeners?(this._listeners[e]&&this._listeners[e].forEach(e=>{e.call(this,n)}),n):n}}class Placeholder{constructor(e,t){this.element=createElement("pswp__img pswp__img--placeholder",e?"img":"",t),e&&(this.element.decoding="async",this.element.alt="",this.element.src=e,this.element.setAttribute("role","presentation")),this.element.setAttribute("aria-hiden","true")}setDisplayedSize(e,t){if(!this.element)return;this.element.tagName==="IMG"?(setWidthHeight(this.element,250,"auto"),this.element.style.transformOrigin="0 0",this.element.style.transform=toTransformString(0,0,e/250)):setWidthHeight(this.element,e,t)}destroy(){this.element.parentNode&&this.element.remove(),this.element=null}}class Content{constructor(e,t,n){this.instance=t,this.data=e,this.index=n,this.element=void 0,this.displayedImageWidth=0,this.displayedImageHeight=0,this.width=Number(this.data.w)||Number(this.data.width)||0,this.height=Number(this.data.h)||Number(this.data.height)||0,this.isAttached=!1,this.hasSlide=!1,this.state=LOAD_STATE.IDLE,this.data.type?this.type=this.data.type:this.data.src?this.type="image":this.type="html",this.instance.dispatch("contentInit",{content:this})}removePlaceholder(){this.placeholder&&!this.keepPlaceholder()&&setTimeout(()=>{this.placeholder&&(this.placeholder.destroy(),this.placeholder=null)},1e3)}load(e,t){if(!this.placeholder&&this.slide&&this.usePlaceholder()){const e=this.instance.applyFilters("placeholderSrc",!!(this.data.msrc&&this.slide.isFirstSlide)&&this.data.msrc,this);this.placeholder=new Placeholder(e,this.slide.container)}if(this.element&&!t)return;if(this.instance.dispatch("contentLoad",{content:this,isLazy:e}).defaultPrevented)return;this.isImageContent()?(this.element=createElement("pswp__img","img"),this.displayedImageWidth&&this.loadImage(e)):(this.element=createElement("pswp__content"),this.element.innerHTML=this.data.html||""),t&&this.slide&&this.slide.updateContentSize(!0)}loadImage(e){const t=this.element;if(this.instance.dispatch("contentLoadImage",{content:this,isLazy:e}).defaultPrevented)return;this.updateSrcsetSizes(),this.data.srcset&&(t.srcset=this.data.srcset),t.src=this.data.src,t.alt=this.data.alt||"",this.state=LOAD_STATE.LOADING,t.complete?this.onLoaded():(t.onload=()=>{this.onLoaded()},t.onerror=()=>{this.onError()})}setSlide(e){this.slide=e,this.hasSlide=!0,this.instance=e.pswp}onLoaded(){this.state=LOAD_STATE.LOADED,this.slide&&(this.instance.dispatch("loadComplete",{slide:this.slide,content:this}),this.slide.isActive&&this.slide.heavyAppended&&!this.element.parentNode&&(this.append(),this.slide.updateContentSize(!0)),(this.state===LOAD_STATE.LOADED||this.state===LOAD_STATE.ERROR)&&this.removePlaceholder())}onError(){this.state=LOAD_STATE.ERROR,this.slide&&(this.displayError(),this.instance.dispatch("loadComplete",{slide:this.slide,isError:!0,content:this}),this.instance.dispatch("loadError",{slide:this.slide,content:this}))}isLoading(){return this.instance.applyFilters("isContentLoading",this.state===LOAD_STATE.LOADING,this)}isError(){return this.state===LOAD_STATE.ERROR}isImageContent(){return this.type==="image"}setDisplayedSize(e,t){if(!this.element)return;if(this.placeholder&&this.placeholder.setDisplayedSize(e,t),this.instance.dispatch("contentResize",{content:this,width:e,height:t}).defaultPrevented)return;if(setWidthHeight(this.element,e,t),this.isImageContent()&&!this.isError()){const n=!this.displayedImageWidth&&e;this.displayedImageWidth=e,this.displayedImageHeight=t,n?this.loadImage(!1):this.updateSrcsetSizes(),this.slide&&this.instance.dispatch("imageSizeChange",{slide:this.slide,width:e,height:t,content:this})}}isZoomable(){return this.instance.applyFilters("isContentZoomable",this.isImageContent()&&this.state!==LOAD_STATE.ERROR,this)}updateSrcsetSizes(){if(this.data.srcset){const e=this.element,t=this.instance.applyFilters("srcsetSizesWidth",this.displayedImageWidth,this);(!e.dataset.largestUsedSize||t>parseInt(e.dataset.largestUsedSize,10))&&(e.sizes=t+"px",e.dataset.largestUsedSize=String(t))}}usePlaceholder(){return this.instance.applyFilters("useContentPlaceholder",this.isImageContent(),this)}lazyLoad(){if(this.instance.dispatch("contentLazyLoad",{content:this}).defaultPrevented)return;this.load(!0)}keepPlaceholder(){return this.instance.applyFilters("isKeepingPlaceholder",this.isLoading(),this)}destroy(){if(this.hasSlide=!1,this.slide=null,this.instance.dispatch("contentDestroy",{content:this}).defaultPrevented)return;this.remove(),this.isImageContent()&&this.element&&(this.element.onload=null,this.element.onerror=null,this.element=null)}displayError(){if(this.slide){let e=createElement("pswp__error-msg");e.innerText=this.instance.options.errorMsg,e=this.instance.applyFilters("contentErrorElement",e,this),this.element=createElement("pswp__content pswp__error-msg-container"),this.element.appendChild(e),this.slide.container.innerText="",this.slide.container.appendChild(this.element),this.slide.updateContentSize(!0),this.removePlaceholder()}}append(){if(this.isAttached)return;if(this.isAttached=!0,this.state===LOAD_STATE.ERROR){this.displayError();return}if(this.instance.dispatch("contentAppend",{content:this}).defaultPrevented)return;const e="decode"in this.element;this.isImageContent()?e&&this.slide&&(!this.slide.isActive||isSafari())?(this.isDecoding=!0,this.element.decode().finally(()=>{this.isDecoding=!1,this.appendImage()})):this.appendImage():this.element&&!this.element.parentNode&&this.slide.container.appendChild(this.element)}activate(){if(this.instance.dispatch("contentActivate",{content:this}).defaultPrevented)return;this.slide&&(this.isImageContent()&&this.isDecoding&&!isSafari()?this.appendImage():this.isError()&&this.load(!1,!0))}deactivate(){this.instance.dispatch("contentDeactivate",{content:this})}remove(){if(this.isAttached=!1,this.instance.dispatch("contentRemove",{content:this}).defaultPrevented)return;this.element&&this.element.parentNode&&this.element.remove()}appendImage(){if(!this.isAttached)return;if(this.instance.dispatch("contentAppendImage",{content:this}).defaultPrevented)return;this.slide&&this.element&&!this.element.parentNode&&this.slide.container.appendChild(this.element),(this.state===LOAD_STATE.LOADED||this.state===LOAD_STATE.ERROR)&&this.removePlaceholder()}}function getViewportSize(e,t){if(e.getViewportSizeFn){const n=e.getViewportSizeFn(e,t);if(n)return n}return{x:document.documentElement.clientWidth,y:window.innerHeight}}function parsePaddingOption(e,t,n,s,o){let i;if(t.paddingFn)i=t.paddingFn(n,s,o)[e];else if(t.padding)i=t.padding[e];else{const n="padding"+e[0].toUpperCase()+e.slice(1);t[n]&&(i=t[n])}return i||0}function getPanAreaSize(e,t,n,s){return{x:t.x-parsePaddingOption("left",e,t,n,s)-parsePaddingOption("right",e,t,n,s),y:t.y-parsePaddingOption("top",e,t,n,s)-parsePaddingOption("bottom",e,t,n,s)}}const MAX_IMAGE_WIDTH=4e3;class ZoomLevel{constructor(e,t,n,s){this.pswp=s,this.options=e,this.itemData=t,this.index=n}update(e,t,n){this.elementSize={x:e,y:t},this.panAreaSize=n;const o=this.panAreaSize.x/this.elementSize.x,s=this.panAreaSize.y/this.elementSize.y;this.fit=Math.min(1,o<s?o:s),this.fill=Math.min(1,o>s?o:s),this.vFill=Math.min(1,s),this.initial=this._getInitial(),this.secondary=this._getSecondary(),this.max=Math.max(this.initial,this.secondary,this._getMax()),this.min=Math.min(this.fit,this.initial,this.secondary),this.pswp&&this.pswp.dispatch("zoomLevelsUpdate",{zoomLevels:this,slideData:this.itemData})}_parseZoomLevelOption(e){const n=e+"ZoomLevel",t=this.options[n];if(!t)return;return typeof t=="function"?t(this):t==="fill"?this.fill:t==="fit"?this.fit:Number(t)}_getSecondary(){let e=this._parseZoomLevelOption("secondary");return e||(e=Math.min(1,this.fit*3),e*this.elementSize.x>MAX_IMAGE_WIDTH&&(e=MAX_IMAGE_WIDTH/this.elementSize.x),e)}_getInitial(){return this._parseZoomLevelOption("initial")||this.fit}_getMax(){const e=this._parseZoomLevelOption("max");return e||Math.max(1,this.fit*4)}}function lazyLoadData(e,t,n){const s=t.createContentFromData(e,n);if(!s||!s.lazyLoad)return;const{options:o}=t,a=t.viewportSize||getViewportSize(o,t),r=getPanAreaSize(o,a,e,n),i=new ZoomLevel(o,e,-1);return i.update(s.width,s.height,r),s.lazyLoad(),s.setDisplayedSize(Math.ceil(s.width*i.initial),Math.ceil(s.height*i.initial)),s}function lazyLoadSlide(e,t){const n=t.getItemData(e);if(t.dispatch("lazyLoadSlide",{index:e,itemData:n}).defaultPrevented)return;return lazyLoadData(n,t,e)}class PhotoSwipeBase extends Eventable{getNumItems(){let t;const{dataSource:e}=this.options;e?"length"in e?t=e.length:"gallery"in e&&(e.items||(e.items=this._getGalleryDOMElements(e.gallery)),e.items&&(t=e.items.length)):t=0;const n=this.dispatch("numItems",{dataSource:e,numItems:t});return this.applyFilters("numItems",n.numItems,e)}createContentFromData(e,t){return new Content(e,this,t)}getItemData(e){const{dataSource:t}=this.options;let s;Array.isArray(t)?s=t[e]:t&&t.gallery&&(t.items||(t.items=this._getGalleryDOMElements(t.gallery)),s=t.items[e]);let n=s;n instanceof Element&&(n=this._domElementToItemData(n));const o=this.dispatch("itemData",{itemData:n||{},index:e});return this.applyFilters("itemData",o.itemData,e)}_getGalleryDOMElements(e){return this.options.children||this.options.childSelector?getElementsFromOption(this.options.children,this.options.childSelector,e)||[]:[e]}_domElementToItemData(e){const t={element:e},n=e.tagName==="A"?e:e.querySelector("a");if(n){t.src=n.dataset.pswpSrc||n.href,n.dataset.pswpSrcset&&(t.srcset=n.dataset.pswpSrcset),t.width=parseInt(n.dataset.pswpWidth,10),t.height=parseInt(n.dataset.pswpHeight,10),t.w=t.width,t.h=t.height,n.dataset.pswpType&&(t.type=n.dataset.pswpType);const s=e.querySelector("img");s&&(t.msrc=s.currentSrc||s.src,t.alt=s.getAttribute("alt")),(n.dataset.pswpCropped||n.dataset.cropped)&&(t.thumbCropped=!0)}return this.applyFilters("domItemData",t,e,n)}lazyLoadData(e,t){return lazyLoadData(e,this,t)}}class PhotoSwipeLightbox extends PhotoSwipeBase{constructor(e){super(),this.options=e||{},this._uid=0}init(){this.onThumbnailsClick=this.onThumbnailsClick.bind(this),getElementsFromOption(this.options.gallery,this.options.gallerySelector).forEach(e=>{e.addEventListener("click",this.onThumbnailsClick,!1)})}onThumbnailsClick(e){if(specialKeyUsed(e)||window.pswp||window.navigator.onLine===!1)return;let t={x:e.clientX,y:e.clientY};!t.x&&!t.y&&(t=null);let n=this.getClickedIndex(e);n=this.applyFilters("clickedIndex",n,e,this);const s={gallery:e.currentTarget};n>=0&&(e.preventDefault(),this.loadAndOpen(n,s,t))}getClickedIndex(e){if(this.options.getClickedIndexFn)return this.options.getClickedIndexFn.call(this,e);const t=e.target,s=getElementsFromOption(this.options.children,this.options.childSelector,e.currentTarget),n=s.findIndex(e=>e===t||e.contains(t));return n!==-1?n:this.options.children||this.options.childSelector?-1:0}loadAndOpen(e,t,n){return!window.pswp&&(this.options.index=e,this.options.initialPointerPos=n,this.shouldOpen=!0,this.preload(e,t),!0)}preload(e,t){const{options:n}=this;t&&(n.dataSource=t);const s=[],o=typeof n.pswpModule;if(isPswpClass(n.pswpModule))s.push(Promise.resolve(n.pswpModule));else if(o==="string")throw new Error("pswpModule as string is no longer supported");if(o==="function")s.push(n.pswpModule());else throw new Error("pswpModule is not valid");typeof n.openPromise=="function"&&s.push(n.openPromise()),n.preloadFirstSlide!==!1&&e>=0&&(this._preloadedContent=lazyLoadSlide(e,this));const i=++this._uid;Promise.all(s).then(e=>{if(this.shouldOpen){const t=e[0];this._openPhotoswipe(t,i)}})}_openPhotoswipe(e,t){if(t!==this._uid&&this.shouldOpen)return;if(this.shouldOpen=!1,window.pswp)return;const n=typeof e=="object"?new e.default(this.options):new e(this.options);this.pswp=n,window.pswp=n,Object.keys(this._listeners).forEach(e=>{this._listeners[e].forEach(t=>{n.on(e,t)})}),Object.keys(this._filters).forEach(e=>{this._filters[e].forEach(t=>{n.addFilter(e,t.fn,t.priority)})}),this._preloadedContent&&(n.contentLoader.addToCache(this._preloadedContent),this._preloadedContent=null),n.on("destroy",()=>{this.pswp=null,window.pswp=null}),n.init()}destroy(){this.pswp&&this.pswp.destroy(),this.shouldOpen=!1,this._listeners=null,getElementsFromOption(this.options.gallery,this.options.gallerySelector).forEach(e=>{e.removeEventListener("click",this.onThumbnailsClick,!1)})}}export{PhotoSwipeLightbox as default}